SELECT
	CARRIER_CD	AS	"carrier",
	SERVICE_NUM_STR	AS	"fltno",
	DEP_PORT_CD	AS	"depapt",
	DEP_CITY_CD	AS	"depcity",
	DEP_CNTRY_CD	AS	"depctry",
	ARR_PORT_CD	AS	"arrpapt",
	ARR_CITY_CD	AS	"arrcity",
	ARR_CNTRY_CD	AS	"arrctry",
	DEP_TIME_LCL	AS	"deptim",
	ARR_TIME_LCL	AS	"arrtim",
	ARR_INTERVAL_DAYS	AS	"arrday",
	ELAPSED_TIME	AS	"elptime",
	OPER_DAYS_OF_WEEK	AS	"days",
	RTRIM(CHAR(STOPS))	AS	"stops",
	OAG.DATEFORMAT(LEG_SEG_EFF_START_DATE,'CCYYMMDD')	AS	"efffrom",
	OAG.DATEFORMAT(LEG_SEG_EFF_END_DATE,'CCYYMMDD')	AS	"effto",
	GEN_ARCRFT_TYPE	AS	"genacft",
	SPCFC_ARCRFT_TYPE	AS	"inpacft",
	SERVICE_TYPE_CD	AS	"service",
	DOM_INT_MARKER	AS	"domint",
	GOVT_APPROVAL_MARKER	AS	"govt_app",
	ARCRFT_CHANGE_MARKER	AS	"acftchange",
	ON_TIME_PERFORMANCE_501	AS	"ontimeperformance501",
	ON_TIME_PERFORMANCE_502	AS	"ontimeperformance502",
	IN_FLGHT_SERVICE	AS	"infltservice",
	SECURE_FLGHT_MARKER	AS	"secureflt",
	E_TICKETING	AS	"eticketing",
	AUTOMATED_CHECK_IN	AS	"automatedcheckin",
	RTRIM(CHAR(AVL_SEATS))	AS	"seats",
	RTRIM(CHAR(AVL_SEATS_FIRST))	AS	"seatsfst",
	RTRIM(CHAR(AVL_SEATS_BUSINESS))	AS	"seatsbus",
	RTRIM(CHAR(AVL_SEATS_ECNMY))	AS	"seatseco",
	RTRIM(CHAR(AVL_SEATS_PREM_ECNMY))	AS	"seatspremeco",
	FREIGHT_CLASSES	AS	"frtclass",
	FREIGHT_TONS	AS	"tons",
	PAX_CLASS	AS	"px",
	FULL_ROUTING	AS	"routing",
	LONGEST_SECTOR_MARKER	AS	"longest",
	INTMDTE_PORTS	AS	"intapt",
	RTRIM(CHAR(DISTANCE_MILES))	AS	"distance",
	COMMENT_10_50	AS	"comm10_50",
	OPERATING_MARKER	AS	"operating",
	DUP_LEG_XML	AS	"dupcarfl",
	GHOST_FLGHT_MARKER	AS	"ghost",
	DUPLICATE_FLGHT_MARKER	AS	"duplicate",
	DEP_TERMINAL_CD	AS	"depterm",
	ARR_TERMINAL_CD	AS	"arrterm",
	OPER_PREFIX	AS	"fltprefx",
	OPER_SUFFIX	AS	"fltsuffx",
	OAG.DATEFORMAT(RELEASE_SELL_START_DATE,'CCYYMMDD')	AS	"release_sell_start_date",
	RESTRICTION	AS	"restrict",
	MEALS	AS	"meals",
	SHARED_AIRLINE_DESIGNATOR	AS	"sad",
	COCKPIT_CREW_PROVIDER	AS	"cockpit_crew_provider",
	CABIN_CREW_PROVIDER	AS	"cabin_crew_provider",
	ARCRFT_OWNER	AS	"acft_owner",
	ALLIANCE	AS	"alliance",
	DEP_TIMEDIV_IATA	AS	"dep_timediv_iata",
	ARR_TIMEDIV_IATA	AS	"arr_timediv_iata",
	DEP_TIMEDIV_OAG	AS	"dep_timediv_oag",
	ARR_TIMEDIV_OAG	AS	"arr_timediv_oag",
	CARRIER_CD_ICAO	AS	"carrier_cd_icao",
	DEP_PORT_CD_ICAO	AS	"dep_port_cd_icao",
	ARR_PORT_CD_ICAO	AS	"arr_port_cd_icao",
	EQUIPMENT_CD_ICAO	AS	"equipment_cd_icao",
	DEP_STATE	AS	"depstate",
	ARR_STATE	AS	"arrstate",
	DEP_TIME_UTC	AS	"dep_time_utc",
	ARR_TIME_UTC	AS	"arr_time_utc",
	UTC_ARR_INTERVAL_DAYS	AS	"utcarrdays",
	OPER_DAYS_OF_WEEK_UTC	AS	"oper_days_of_week_utc",
	OAG.DATEFORMAT(UTC_EFF_START_DATE,'CCYYMMDD')	AS	"utcefffrom",
	OAG.DATEFORMAT(UTC_EFF_END_DATE,'CCYYMMDD')	AS	"utceffto",
	SCHED_VERSION_NAME	AS	"sched_version_name",
	BOARDING_OFFBOARDING_QUALIFIER	AS	"boardingOfffBoardingQualifier",
	LAST_IV_UPDATE	AS	"last_iv_update"
FROM SNAPSHOT.WDF_MASTER_DATA_UNENHANCED
WHERE 1=1
AND CARRIER_CD = 'AA' AND SERVICE_NUM = 1
 ORDER BY RELEASE_SELL_START_DATE, SCHED_VERSION_NAME, LEG_SEG_EFF_START_DATE, LEG_SEG_EFF_END_DATE, OPER_DAYS_OF_WEEK, STOPS with ur