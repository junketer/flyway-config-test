//TESTED
import org.apache.spark.sql.functions.{asc, col}

val withRoutingList = ivListProcessing.addFullRoutingList(enrichedLegs)
val withLongIntmdtePorts = withRoutingList.where(col("iv_id").equalTo(255032376)).select("full_routing", "leg_seg_id", "longest_sector_marker").orderBy(asc("leg_seg_id")).collect
assert(withLongIntmdtePorts(2).getAs[String]("longest_sector_marker") == "")
assert(withLongIntmdtePorts(3).getAs[String]("longest_sector_marker") == "L")
assert(withLongIntmdtePorts(4).getAs[String]("longest_sector_marker") == "")

assert(withLongIntmdtePorts(4).getAs[String]("full_routing") == "YQTYXLYHDYRLYWG")